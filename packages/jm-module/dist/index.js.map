{"version":3,"file":"index.js","sources":["../lib/index.js"],"sourcesContent":["/**\n * module.\n * @module module\n */\n\n/**\n * Class representing a modulable object.\n *\n */\nclass Modulable {\n  /**\n     * Create an modulable object.\n     */\n  constructor () {\n    this._modules = {}\n  }\n\n  /**\n     * modules\n     * @return {Object}\n     */\n  get modules () {\n    return this._modules\n  }\n\n  /**\n     * use a module\n     * @param {Function} fn module function\n     * @param args any arguments\n     * @return {Modulable} for chaining\n     */\n  use (fn, ...args) {\n    let m = fn.apply(this, args)\n    if (m && m.name) {\n      this._modules[m.name] = m\n    }\n    return this\n  }\n\n  /**\n     * unuse a module\n     * @param {Object|String} nameOrModule module or name to be unused\n     * @return {Modulable} for chaining\n     */\n  unuse (nameOrModule) {\n    let m = nameOrModule\n    if (typeof m === 'string') m = this._modules[m]\n    if (m && m.unuse) {\n      if (m.name) {\n        delete this._modules[m.name]\n      }\n      m.unuse()\n    }\n    return this\n  }\n}\n\nlet prototype = Modulable.prototype\nlet M = {\n  _modules: {},\n  use: prototype.use,\n  unuse: prototype.unuse\n}\n\n/**\n * enable modulable support for obj\n * @param {Object} obj target object\n * @return {boolean}\n */\nlet enableModule = (obj) => {\n  if (obj.use !== undefined) return false\n  for (let key in M) {\n    obj[key] = M[key]\n  }\n  obj._modules = {}\n\n  Object.defineProperty(\n    obj,\n    'modules',\n    {\n      value: obj._modules,\n      writable: false\n    }\n  )\n\n  return true\n}\n\n/**\n * disable modulable support for obj\n * @param {Object} obj target object\n */\nlet disableModule = (obj) => {\n  if (obj.use === undefined) return\n  for (let key in M) {\n    delete obj[key]\n  }\n}\n\nlet $ = {\n  Modulable: Modulable,\n  enableModule: enableModule,\n  disableModule: disableModule\n}\n\nmodule.exports = $\n"],"names":["Modulable","_modules","fn","args","m","apply","name","nameOrModule","unuse","prototype","M","use","enableModule","obj","undefined","key","Object","defineProperty","value","writable","disableModule","$"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;;;;;;;;IASMA;;;;;;uBAIW;;;SACRC,QAAL,GAAgB,EAAhB;;;;;;;;;;;;;;;;;wBAiBGC,IAAa;wCAANC,IAAM;QAANA,IAAM;;;UACZC,CAAC,GAAGF,EAAE,CAACG,KAAH,CAAS,IAAT,EAAeF,IAAf,CAAR;;UACIC,CAAC,IAAIA,CAAC,CAACE,IAAX,EAAiB;aACVL,QAAL,CAAcG,CAAC,CAACE,IAAhB,IAAwBF,CAAxB;;;aAEK,IAAP;;;;;;;;;;0BAQKG,cAAc;UACfH,CAAC,GAAGG,YAAR;UACI,OAAOH,CAAP,KAAa,QAAjB,EAA2BA,CAAC,GAAG,KAAKH,QAAL,CAAcG,CAAd,CAAJ;;UACvBA,CAAC,IAAIA,CAAC,CAACI,KAAX,EAAkB;YACZJ,CAAC,CAACE,IAAN,EAAY;iBACH,KAAKL,QAAL,CAAcG,CAAC,CAACE,IAAhB,CAAP;;;QAEFF,CAAC,CAACI,KAAF;;;aAEK,IAAP;;;;wBAhCa;aACN,KAAKP,QAAZ;;;;;;;AAmCJ,IAAIQ,SAAS,GAAGT,SAAS,CAACS,SAA1B;AACA,IAAIC,CAAC,GAAG;EACNT,QAAQ,EAAE,EADJ;EAENU,GAAG,EAAEF,SAAS,CAACE,GAFT;EAGNH,KAAK,EAAEC,SAAS,CAACD;;;;;;;CAHnB;;AAWA,IAAII,YAAY,GAAG,SAAfA,YAAe,CAACC,GAAD,EAAS;MACtBA,GAAG,CAACF,GAAJ,KAAYG,SAAhB,EAA2B,OAAO,KAAP;;OACtB,IAAIC,GAAT,IAAgBL,CAAhB,EAAmB;IACjBG,GAAG,CAACE,GAAD,CAAH,GAAWL,CAAC,CAACK,GAAD,CAAZ;;;EAEFF,GAAG,CAACZ,QAAJ,GAAe,EAAf;EAEAe,MAAM,CAACC,cAAP,CACEJ,GADF,EAEE,SAFF,EAGE;IACEK,KAAK,EAAEL,GAAG,CAACZ,QADb;IAEEkB,QAAQ,EAAE;GALd;SASO,IAAP;CAhBF;;;;;;;AAuBA,IAAIC,aAAa,GAAG,SAAhBA,aAAgB,CAACP,GAAD,EAAS;MACvBA,GAAG,CAACF,GAAJ,KAAYG,SAAhB,EAA2B;;OACtB,IAAIC,GAAT,IAAgBL,CAAhB,EAAmB;WACVG,GAAG,CAACE,GAAD,CAAV;;CAHJ;;AAOA,IAAIM,CAAC,GAAG;EACNrB,SAAS,EAAEA,SADL;EAENY,YAAY,EAAEA,YAFR;EAGNQ,aAAa,EAAEA;CAHjB;AAMA,OAAc,GAAGC,CAAjB;;;;"}