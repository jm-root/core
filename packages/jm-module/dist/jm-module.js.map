{"version":3,"file":"jm-module.js","sources":["../lib/index.js"],"sourcesContent":["/**\n * module.\n * @module module\n */\n\n/**\n * Class representing a modulable object.\n *\n */\nclass Modulable {\n  /**\n     * Create an modulable object.\n     */\n  constructor () {\n    this._modules = {}\n  }\n\n  /**\n     * modules\n     * @return {Object}\n     */\n  get modules () {\n    return this._modules\n  }\n\n  /**\n     * use a module\n     * @param {Function} fn module function\n     * @param args any arguments\n     * @return {Modulable} for chaining\n     */\n  use (fn, ...args) {\n    let m = fn.apply(this, args)\n    if (m && m.name) {\n      this._modules[m.name] = m\n    }\n    return this\n  }\n\n  /**\n     * unuse a module\n     * @param {Object|String} nameOrModule module or name to be unused\n     * @return {Modulable} for chaining\n     */\n  unuse (nameOrModule) {\n    let m = nameOrModule\n    if (typeof m === 'string') m = this._modules[m]\n    if (m && m.unuse) {\n      if (m.name) {\n        delete this._modules[m.name]\n      }\n      m.unuse()\n    }\n    return this\n  }\n}\n\nlet prototype = Modulable.prototype\nlet M = {\n  _modules: {},\n  use: prototype.use,\n  unuse: prototype.unuse\n}\n\n/**\n * enable modulable support for obj\n * @param {Object} obj target object\n * @return {boolean}\n */\nlet enableModule = (obj) => {\n  if (obj.use !== undefined) return false\n  for (let key in M) {\n    obj[key] = M[key]\n  }\n  obj._modules = {}\n\n  Object.defineProperty(\n    obj,\n    'modules',\n    {\n      value: obj._modules,\n      writable: false\n    }\n  )\n\n  return true\n}\n\n/**\n * disable modulable support for obj\n * @param {Object} obj target object\n */\nlet disableModule = (obj) => {\n  if (obj.use === undefined) return\n  for (let key in M) {\n    delete obj[key]\n  }\n}\n\nlet $ = {\n  Modulable: Modulable,\n  enableModule: enableModule,\n  disableModule: disableModule\n}\n\nmodule.exports = $\n"],"names":["Modulable","_modules","fn","args","m","apply","name","nameOrModule","unuse","prototype","M","use","enableModule","obj","undefined","key","Object","defineProperty","value","writable","disableModule","$"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;EAAA;;;;;;;;;MASMA;;;;;;EAIJ,uBAAe;EAAA;;EACb,SAAKC,QAAL,GAAgB,EAAhB;EACD;;;;;;;;;;;;;;;;0BAgBIC,IAAa;EAAA,wCAANC,IAAM;EAANA,QAAAA,IAAM;EAAA;;EAChB,UAAIC,CAAC,GAAGF,EAAE,CAACG,KAAH,CAAS,IAAT,EAAeF,IAAf,CAAR;;EACA,UAAIC,CAAC,IAAIA,CAAC,CAACE,IAAX,EAAiB;EACf,aAAKL,QAAL,CAAcG,CAAC,CAACE,IAAhB,IAAwBF,CAAxB;EACD;;EACD,aAAO,IAAP;EACD;;;;;;;;;4BAOMG,cAAc;EACnB,UAAIH,CAAC,GAAGG,YAAR;EACA,UAAI,OAAOH,CAAP,KAAa,QAAjB,EAA2BA,CAAC,GAAG,KAAKH,QAAL,CAAcG,CAAd,CAAJ;;EAC3B,UAAIA,CAAC,IAAIA,CAAC,CAACI,KAAX,EAAkB;EAChB,YAAIJ,CAAC,CAACE,IAAN,EAAY;EACV,iBAAO,KAAKL,QAAL,CAAcG,CAAC,CAACE,IAAhB,CAAP;EACD;;EACDF,QAAAA,CAAC,CAACI,KAAF;EACD;;EACD,aAAO,IAAP;EACD;;;0BAjCc;EACb,aAAO,KAAKP,QAAZ;EACD;;;;;;EAkCH,IAAIQ,SAAS,GAAGT,SAAS,CAACS,SAA1B;EACA,IAAIC,CAAC,GAAG;EACNT,EAAAA,QAAQ,EAAE,EADJ;EAENU,EAAAA,GAAG,EAAEF,SAAS,CAACE,GAFT;EAGNH,EAAAA,KAAK,EAAEC,SAAS,CAACD;;;;;;;EAHX,CAAR;;EAWA,IAAII,YAAY,GAAG,SAAfA,YAAe,CAACC,GAAD,EAAS;EAC1B,MAAIA,GAAG,CAACF,GAAJ,KAAYG,SAAhB,EAA2B,OAAO,KAAP;;EAC3B,OAAK,IAAIC,GAAT,IAAgBL,CAAhB,EAAmB;EACjBG,IAAAA,GAAG,CAACE,GAAD,CAAH,GAAWL,CAAC,CAACK,GAAD,CAAZ;EACD;;EACDF,EAAAA,GAAG,CAACZ,QAAJ,GAAe,EAAf;EAEAe,EAAAA,MAAM,CAACC,cAAP,CACEJ,GADF,EAEE,SAFF,EAGE;EACEK,IAAAA,KAAK,EAAEL,GAAG,CAACZ,QADb;EAEEkB,IAAAA,QAAQ,EAAE;EAFZ,GAHF;EASA,SAAO,IAAP;EACD,CAjBD;;;;;;;EAuBA,IAAIC,aAAa,GAAG,SAAhBA,aAAgB,CAACP,GAAD,EAAS;EAC3B,MAAIA,GAAG,CAACF,GAAJ,KAAYG,SAAhB,EAA2B;;EAC3B,OAAK,IAAIC,GAAT,IAAgBL,CAAhB,EAAmB;EACjB,WAAOG,GAAG,CAACE,GAAD,CAAV;EACD;EACF,CALD;;EAOA,IAAIM,CAAC,GAAG;EACNrB,EAAAA,SAAS,EAAEA,SADL;EAENY,EAAAA,YAAY,EAAEA,YAFR;EAGNQ,EAAAA,aAAa,EAAEA;EAHT,CAAR;EAMA,OAAc,GAAGC,CAAjB;;;;;;;;;;;;"}