{"version":3,"file":"index.esm.js","sources":["../lib/index.js"],"sourcesContent":["/**\n * module.\n * @module module\n */\n\n/**\n * Class representing a modulable object.\n *\n */\nclass Modulable {\n  /**\n     * Create an modulable object.\n     */\n  constructor () {\n    this._modules = {}\n  }\n\n  /**\n     * modules\n     * @return {Object}\n     */\n  get modules () {\n    return this._modules\n  }\n\n  /**\n     * use a module\n     * @param {Function} fn module function\n     * @param args any arguments\n     * @return {Modulable} for chaining\n     */\n  use (fn, ...args) {\n    let m = fn.apply(this, args)\n    if (m && m.name) {\n      this._modules[m.name] = m\n    }\n    return this\n  }\n\n  /**\n     * unuse a module\n     * @param {Object|String} nameOrModule module or name to be unused\n     * @return {Modulable} for chaining\n     */\n  unuse (nameOrModule) {\n    let m = nameOrModule\n    if (typeof m === 'string') m = this._modules[m]\n    if (m && m.unuse) {\n      if (m.name) {\n        delete this._modules[m.name]\n      }\n      m.unuse()\n    }\n    return this\n  }\n}\n\nlet prototype = Modulable.prototype\nlet M = {\n  _modules: {},\n  use: prototype.use,\n  unuse: prototype.unuse\n}\n\n/**\n * enable modulable support for obj\n * @param {Object} obj target object\n * @return {boolean}\n */\nlet enableModule = (obj) => {\n  if (obj.use !== undefined) return false\n  for (let key in M) {\n    obj[key] = M[key]\n  }\n  obj._modules = {}\n\n  Object.defineProperty(\n    obj,\n    'modules',\n    {\n      value: obj._modules,\n      writable: false\n    }\n  )\n\n  return true\n}\n\n/**\n * disable modulable support for obj\n * @param {Object} obj target object\n */\nlet disableModule = (obj) => {\n  if (obj.use === undefined) return\n  for (let key in M) {\n    delete obj[key]\n  }\n}\n\nlet $ = {\n  Modulable: Modulable,\n  enableModule: enableModule,\n  disableModule: disableModule\n}\n\nmodule.exports = $\n"],"names":["Modulable","_modules","fn","args","m","apply","name","nameOrModule","unuse","prototype","M","use","enableModule","obj","undefined","key","Object","defineProperty","value","writable","disableModule","$"],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAAA;;;;;AAKA;;;;IAIMA;;;;AAIJ,uBAAe;AAAA;;AACb,SAAKC,QAAL,GAAgB,EAAhB;AACD;;;;;;;;;;;;;;;;wBAgBIC,IAAa;AAAA,wCAANC,IAAM;AAANA,QAAAA,IAAM;AAAA;;AAChB,UAAIC,CAAC,GAAGF,EAAE,CAACG,KAAH,CAAS,IAAT,EAAeF,IAAf,CAAR;;AACA,UAAIC,CAAC,IAAIA,CAAC,CAACE,IAAX,EAAiB;AACf,aAAKL,QAAL,CAAcG,CAAC,CAACE,IAAhB,IAAwBF,CAAxB;AACD;;AACD,aAAO,IAAP;AACD;;;;;;;;;0BAOMG,cAAc;AACnB,UAAIH,CAAC,GAAGG,YAAR;AACA,UAAI,OAAOH,CAAP,KAAa,QAAjB,EAA2BA,CAAC,GAAG,KAAKH,QAAL,CAAcG,CAAd,CAAJ;;AAC3B,UAAIA,CAAC,IAAIA,CAAC,CAACI,KAAX,EAAkB;AAChB,YAAIJ,CAAC,CAACE,IAAN,EAAY;AACV,iBAAO,KAAKL,QAAL,CAAcG,CAAC,CAACE,IAAhB,CAAP;AACD;;AACDF,QAAAA,CAAC,CAACI,KAAF;AACD;;AACD,aAAO,IAAP;AACD;;;wBAjCc;AACb,aAAO,KAAKP,QAAZ;AACD;;;;;;AAkCH,IAAIQ,SAAS,GAAGT,SAAS,CAACS,SAA1B;AACA,IAAIC,CAAC,GAAG;AACNT,EAAAA,QAAQ,EAAE,EADJ;AAENU,EAAAA,GAAG,EAAEF,SAAS,CAACE,GAFT;AAGNH,EAAAA,KAAK,EAAEC,SAAS,CAACD;AAHX,CAAR;AAMA;;;;;;AAKA,IAAII,YAAY,GAAG,SAAfA,YAAe,CAACC,GAAD,EAAS;AAC1B,MAAIA,GAAG,CAACF,GAAJ,KAAYG,SAAhB,EAA2B,OAAO,KAAP;;AAC3B,OAAK,IAAIC,GAAT,IAAgBL,CAAhB,EAAmB;AACjBG,IAAAA,GAAG,CAACE,GAAD,CAAH,GAAWL,CAAC,CAACK,GAAD,CAAZ;AACD;;AACDF,EAAAA,GAAG,CAACZ,QAAJ,GAAe,EAAf;AAEAe,EAAAA,MAAM,CAACC,cAAP,CACEJ,GADF,EAEE,SAFF,EAGE;AACEK,IAAAA,KAAK,EAAEL,GAAG,CAACZ,QADb;AAEEkB,IAAAA,QAAQ,EAAE;AAFZ,GAHF;AASA,SAAO,IAAP;AACD,CAjBD;AAmBA;;;;;;AAIA,IAAIC,aAAa,GAAG,SAAhBA,aAAgB,CAACP,GAAD,EAAS;AAC3B,MAAIA,GAAG,CAACF,GAAJ,KAAYG,SAAhB,EAA2B;;AAC3B,OAAK,IAAIC,GAAT,IAAgBL,CAAhB,EAAmB;AACjB,WAAOG,GAAG,CAACE,GAAD,CAAV;AACD;AACF,CALD;;AAOA,IAAIM,CAAC,GAAG;AACNrB,EAAAA,SAAS,EAAEA,SADL;AAENY,EAAAA,YAAY,EAAEA,YAFR;AAGNQ,EAAAA,aAAa,EAAEA;AAHT,CAAR;AAMA,OAAc,GAAGC,CAAjB;;;;"}