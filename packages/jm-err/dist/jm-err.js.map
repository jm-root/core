{"version":3,"file":"jm-err.js","sources":["../lib/locale/zh_CN.js","../lib/locale/index.js","../lib/index.js"],"sourcesContent":["module.exports = {\n  'Success': '成功',\n  'Fail': '失败',\n  'System Error': '系统错误',\n  'Network Error': '网络错误',\n  'Parameter Error': '参数错误',\n  'Busy': '忙',\n  'Time Out': '超时',\n  'Abort': '中止',\n  'Not Ready': '未准备好',\n  'Not Exists': '不存在',\n  'Already Exists': '已存在',\n  'Validation Error': '校验错误',\n  'OK': 'OK',\n  'Bad Request': '错误请求',\n  'Unauthorized': '未验证',\n  'Forbidden': '无权限',\n  'Not Found': '未找到',\n  'Internal Server Error': '服务器内部错误',\n  'Service Unavailable': '无效服务'\n}\n","const lngs = {\n  zh_CN: require('./zh_CN')\n}\n\n/**\n * translate\n * @param {string} msg - msg to be translate\n * @param {string} lng - language\n * @return {String | null}\n */\nmodule.exports = function (msg, lng) {\n  if (!lng || !lngs[lng]) return null\n  return lngs[lng][msg]\n};\n","/**\n * err module.\n * @module err\n */\n\nconst t = require('./locale')\n\nfunction isNumber (obj) {\n  return typeof obj === 'number' && isFinite(obj)\n}\n\n/**\n * common error defines\n *\n */\nlet Err = {\n  SUCCESS: {\n    err: 0,\n    msg: 'Success'\n  },\n\n  FAIL: {\n    err: 1,\n    msg: 'Fail'\n  },\n\n  FA_SYS: {\n    err: 2,\n    msg: 'System Error'\n  },\n\n  FA_NETWORK: {\n    err: 3,\n    msg: 'Network Error'\n  },\n\n  FA_PARAMS: {\n    err: 4,\n    msg: 'Parameter Error'\n  },\n\n  FA_BUSY: {\n    err: 5,\n    msg: 'Busy'\n  },\n\n  FA_TIMEOUT: {\n    err: 6,\n    msg: 'Time Out'\n  },\n\n  FA_ABORT: {\n    err: 7,\n    msg: 'Abort'\n  },\n\n  FA_NOTREADY: {\n    err: 8,\n    msg: 'Not Ready'\n  },\n\n  FA_NOTEXISTS: {\n    err: 9,\n    msg: 'Not Exists'\n  },\n\n  FA_EXISTS: {\n    err: 10,\n    msg: 'Already Exists'\n  },\n\n  FA_VALIDATION: {\n    err: 11,\n    msg: 'Validation Error'\n  },\n\n  OK: {\n    err: 200,\n    msg: 'OK'\n  },\n\n  FA_BADREQUEST: {\n    err: 400,\n    msg: 'Bad Request'\n  },\n\n  FA_NOAUTH: {\n    err: 401,\n    msg: 'Unauthorized'\n  },\n\n  FA_NOPERMISSION: {\n    err: 403,\n    msg: 'Forbidden'\n  },\n\n  FA_NOTFOUND: {\n    err: 404,\n    msg: 'Not Found'\n  },\n\n  FA_INTERNALERROR: {\n    err: 500,\n    msg: 'Internal Server Error'\n  },\n\n  FA_UNAVAILABLE: {\n    err: 503,\n    msg: 'Service Unavailable'\n  }\n}\n\nErr.t = t\n\n/**\n * return message from template\n *\n * ```javascript\n * errMsg('sampe ${name} ${value}', {name: 'jeff', value: 123});\n * // return 'sample jeff 123'\n * ```\n *\n * @param {String} msg message template\n * @param {Object} opts params\n * @return {String} final message\n */\nfunction errMsg (msg, opts) {\n  if (opts) {\n    for (let key in opts) {\n      msg = msg.split('${' + key + '}').join(opts[key])\n    }\n  }\n  return msg\n}\n\n/**\n * return an Error Object\n * @param {Object|String} E Err object or a message template\n * @param {Object} [opts] params\n * @return {Error}\n */\nfunction err (E, opts){\n  if (typeof E === 'string') {\n    E = {\n      msg: E\n    }\n  }\n  let msg = errMsg(E.msg || E.message, opts)\n  let code = E.err\n  code === undefined && (code = Err.FAIL.err)\n  let status = Err.FA_INTERNALERROR.err\n  if (code === Err.SUCCESS.err) status = 200\n  if (isNumber(code) && code >= 200 && code <= 600) status = code\n  E.status !== undefined && (status = E.status)\n  let e = new Error(msg)\n  e.code = code\n  e.status = status\n  e.data = Object.assign(E, {err: code, msg, status})\n  return e\n}\n\n/**\n * enable Err Object, errMsg and err function for obj\n * @param {Object} obj target object\n * @param {String} [name] name to bind\n * @return {boolean}\n */\nfunction enableErr(obj, name = 'Err') {\n  if (obj[name]) return false\n  obj[name] = Err\n  obj.err = err\n  obj.errMsg = errMsg\n  return true\n}\n\n/**\n * disable Err Object, errMsg and err function for obj\n * @param {Object} obj target object\n * @param {String} [name] name to bind\n */\nfunction disableErr(obj, name = 'Err') {\n  if (!obj[name]) return\n  delete obj[name]\n  delete obj.err\n  delete obj.errMsg\n}\n\nlet $ = {\n  Err: Err,\n  errMsg: errMsg,\n  err: err,\n  enableErr: enableErr,\n  disableErr: disableErr\n}\n\nmodule.exports = $\n"],"names":["lngs","zh_CN","require$$0","msg","lng","isNumber","obj","isFinite","Err","SUCCESS","err","FAIL","FA_SYS","FA_NETWORK","FA_PARAMS","FA_BUSY","FA_TIMEOUT","FA_ABORT","FA_NOTREADY","FA_NOTEXISTS","FA_EXISTS","FA_VALIDATION","OK","FA_BADREQUEST","FA_NOAUTH","FA_NOPERMISSION","FA_NOTFOUND","FA_INTERNALERROR","FA_UNAVAILABLE","t","errMsg","opts","key","split","join","E","message","code","undefined","status","e","Error","data","Object","assign","enableErr","name","disableErr","$"],"mappings":";;;;;;EAAA,SAAc,GAAG;EACf,aAAW,IADI;EAEf,UAAQ,IAFO;EAGf,kBAAgB,MAHD;EAIf,mBAAiB,MAJF;EAKf,qBAAmB,MALJ;EAMf,UAAQ,GANO;EAOf,cAAY,IAPG;EAQf,WAAS,IARM;EASf,eAAa,MATE;EAUf,gBAAc,KAVC;EAWf,oBAAkB,KAXH;EAYf,sBAAoB,MAZL;EAaf,QAAM,IAbS;EAcf,iBAAe,MAdA;EAef,kBAAgB,KAfD;EAgBf,eAAa,KAhBE;EAiBf,eAAa,KAjBE;EAkBf,2BAAyB,SAlBV;EAmBf,yBAAuB;EAnBR,CAAjB;;ECAA,IAAMA,IAAI,GAAG;EACXC,EAAAA,KAAK,EAAEC;;;;;;;;EADI,CAAb;;EAUA,UAAc,GAAG,eAAA,CAAUC,GAAV,EAAeC,GAAf,EAAoB;EACnC,MAAI,CAACA,GAAD,IAAQ,CAACJ,IAAI,CAACI,GAAD,CAAjB,EAAwB,OAAO,IAAP;EACxB,SAAOJ,IAAI,CAACI,GAAD,CAAJ,CAAUD,GAAV,CAAP;EACD,CAHD;;ECVA;;;;;EAOA,SAASE,QAAT,CAAmBC,GAAnB,EAAwB;EACtB,SAAO,OAAOA,GAAP,KAAe,QAAf,IAA2BC,QAAQ,CAACD,GAAD,CAA1C;EACD;;;;;;;EAMD,IAAIE,GAAG,GAAG;EACRC,EAAAA,OAAO,EAAE;EACPC,IAAAA,GAAG,EAAE,CADE;EAEPP,IAAAA,GAAG,EAAE;EAFE,GADD;EAMRQ,EAAAA,IAAI,EAAE;EACJD,IAAAA,GAAG,EAAE,CADD;EAEJP,IAAAA,GAAG,EAAE;EAFD,GANE;EAWRS,EAAAA,MAAM,EAAE;EACNF,IAAAA,GAAG,EAAE,CADC;EAENP,IAAAA,GAAG,EAAE;EAFC,GAXA;EAgBRU,EAAAA,UAAU,EAAE;EACVH,IAAAA,GAAG,EAAE,CADK;EAEVP,IAAAA,GAAG,EAAE;EAFK,GAhBJ;EAqBRW,EAAAA,SAAS,EAAE;EACTJ,IAAAA,GAAG,EAAE,CADI;EAETP,IAAAA,GAAG,EAAE;EAFI,GArBH;EA0BRY,EAAAA,OAAO,EAAE;EACPL,IAAAA,GAAG,EAAE,CADE;EAEPP,IAAAA,GAAG,EAAE;EAFE,GA1BD;EA+BRa,EAAAA,UAAU,EAAE;EACVN,IAAAA,GAAG,EAAE,CADK;EAEVP,IAAAA,GAAG,EAAE;EAFK,GA/BJ;EAoCRc,EAAAA,QAAQ,EAAE;EACRP,IAAAA,GAAG,EAAE,CADG;EAERP,IAAAA,GAAG,EAAE;EAFG,GApCF;EAyCRe,EAAAA,WAAW,EAAE;EACXR,IAAAA,GAAG,EAAE,CADM;EAEXP,IAAAA,GAAG,EAAE;EAFM,GAzCL;EA8CRgB,EAAAA,YAAY,EAAE;EACZT,IAAAA,GAAG,EAAE,CADO;EAEZP,IAAAA,GAAG,EAAE;EAFO,GA9CN;EAmDRiB,EAAAA,SAAS,EAAE;EACTV,IAAAA,GAAG,EAAE,EADI;EAETP,IAAAA,GAAG,EAAE;EAFI,GAnDH;EAwDRkB,EAAAA,aAAa,EAAE;EACbX,IAAAA,GAAG,EAAE,EADQ;EAEbP,IAAAA,GAAG,EAAE;EAFQ,GAxDP;EA6DRmB,EAAAA,EAAE,EAAE;EACFZ,IAAAA,GAAG,EAAE,GADH;EAEFP,IAAAA,GAAG,EAAE;EAFH,GA7DI;EAkERoB,EAAAA,aAAa,EAAE;EACbb,IAAAA,GAAG,EAAE,GADQ;EAEbP,IAAAA,GAAG,EAAE;EAFQ,GAlEP;EAuERqB,EAAAA,SAAS,EAAE;EACTd,IAAAA,GAAG,EAAE,GADI;EAETP,IAAAA,GAAG,EAAE;EAFI,GAvEH;EA4ERsB,EAAAA,eAAe,EAAE;EACff,IAAAA,GAAG,EAAE,GADU;EAEfP,IAAAA,GAAG,EAAE;EAFU,GA5ET;EAiFRuB,EAAAA,WAAW,EAAE;EACXhB,IAAAA,GAAG,EAAE,GADM;EAEXP,IAAAA,GAAG,EAAE;EAFM,GAjFL;EAsFRwB,EAAAA,gBAAgB,EAAE;EAChBjB,IAAAA,GAAG,EAAE,GADW;EAEhBP,IAAAA,GAAG,EAAE;EAFW,GAtFV;EA2FRyB,EAAAA,cAAc,EAAE;EACdlB,IAAAA,GAAG,EAAE,GADS;EAEdP,IAAAA,GAAG,EAAE;EAFS;EA3FR,CAAV;EAiGAK,GAAG,CAACqB,CAAJ,GAAQA,MAAR;;;;;;;;;;;;;;EAcA,SAASC,MAAT,CAAiB3B,GAAjB,EAAsB4B,IAAtB,EAA4B;EAC1B,MAAIA,IAAJ,EAAU;EACR,SAAK,IAAIC,GAAT,IAAgBD,IAAhB,EAAsB;EACpB5B,MAAAA,GAAG,GAAGA,GAAG,CAAC8B,KAAJ,CAAU,OAAOD,GAAP,GAAa,GAAvB,EAA4BE,IAA5B,CAAiCH,IAAI,CAACC,GAAD,CAArC,CAAN;EACD;EACF;;EACD,SAAO7B,GAAP;EACD;;;;;;;;;EAQD,SAASO,GAAT,CAAcyB,CAAd,EAAiBJ,IAAjB,EAAsB;EACpB,MAAI,OAAOI,CAAP,KAAa,QAAjB,EAA2B;EACzBA,IAAAA,CAAC,GAAG;EACFhC,MAAAA,GAAG,EAAEgC;EADH,KAAJ;EAGD;;EACD,MAAIhC,GAAG,GAAG2B,MAAM,CAACK,CAAC,CAAChC,GAAF,IAASgC,CAAC,CAACC,OAAZ,EAAqBL,IAArB,CAAhB;EACA,MAAIM,IAAI,GAAGF,CAAC,CAACzB,GAAb;EACA2B,EAAAA,IAAI,KAAKC,SAAT,KAAuBD,IAAI,GAAG7B,GAAG,CAACG,IAAJ,CAASD,GAAvC;EACA,MAAI6B,MAAM,GAAG/B,GAAG,CAACmB,gBAAJ,CAAqBjB,GAAlC;EACA,MAAI2B,IAAI,KAAK7B,GAAG,CAACC,OAAJ,CAAYC,GAAzB,EAA8B6B,MAAM,GAAG,GAAT;EAC9B,MAAIlC,QAAQ,CAACgC,IAAD,CAAR,IAAkBA,IAAI,IAAI,GAA1B,IAAiCA,IAAI,IAAI,GAA7C,EAAkDE,MAAM,GAAGF,IAAT;EAClDF,EAAAA,CAAC,CAACI,MAAF,KAAaD,SAAb,KAA2BC,MAAM,GAAGJ,CAAC,CAACI,MAAtC;EACA,MAAIC,CAAC,GAAG,IAAIC,KAAJ,CAAUtC,GAAV,CAAR;EACAqC,EAAAA,CAAC,CAACH,IAAF,GAASA,IAAT;EACAG,EAAAA,CAAC,CAACD,MAAF,GAAWA,MAAX;EACAC,EAAAA,CAAC,CAACE,IAAF,GAASC,MAAM,CAACC,MAAP,CAAcT,CAAd,EAAiB;EAACzB,IAAAA,GAAG,EAAE2B,IAAN;EAAYlC,IAAAA,GAAG,EAAHA,GAAZ;EAAiBoC,IAAAA,MAAM,EAANA;EAAjB,GAAjB,CAAT;EACA,SAAOC,CAAP;EACD;;;;;;;;;EAQD,SAASK,SAAT,CAAmBvC,GAAnB,EAAsC;EAAA,MAAdwC,IAAc,uEAAP,KAAO;EACpC,MAAIxC,GAAG,CAACwC,IAAD,CAAP,EAAe,OAAO,KAAP;EACfxC,EAAAA,GAAG,CAACwC,IAAD,CAAH,GAAYtC,GAAZ;EACAF,EAAAA,GAAG,CAACI,GAAJ,GAAUA,GAAV;EACAJ,EAAAA,GAAG,CAACwB,MAAJ,GAAaA,MAAb;EACA,SAAO,IAAP;EACD;;;;;;;;EAOD,SAASiB,UAAT,CAAoBzC,GAApB,EAAuC;EAAA,MAAdwC,IAAc,uEAAP,KAAO;EACrC,MAAI,CAACxC,GAAG,CAACwC,IAAD,CAAR,EAAgB;EAChB,SAAOxC,GAAG,CAACwC,IAAD,CAAV;EACA,SAAOxC,GAAG,CAACI,GAAX;EACA,SAAOJ,GAAG,CAACwB,MAAX;EACD;;EAED,IAAIkB,CAAC,GAAG;EACNxC,EAAAA,GAAG,EAAEA,GADC;EAENsB,EAAAA,MAAM,EAAEA,MAFF;EAGNpB,EAAAA,GAAG,EAAEA,GAHC;EAINmC,EAAAA,SAAS,EAAEA,SAJL;EAKNE,EAAAA,UAAU,EAAEA;EALN,CAAR;EAQA,OAAc,GAAGC,CAAjB;;;;;;;;;;;;"}