{"version":3,"file":"index.esm.js","sources":["../lib/index.js"],"sourcesContent":["let argsClass = '[object Arguments]'\nlet arrayClass = '[object Array]'\nlet boolClass = '[object Boolean]'\nlet dateClass = '[object Date]'\nlet funcClass = '[object Function]'\nlet numberClass = '[object Number]'\nlet objectClass = '[object Object]'\nlet regexpClass = '[object RegExp]'\nlet stringClass = '[object String]'\n\n/** Used to identify object classifications that `cloneDeep` supports */\nlet cloneableClasses = {}\ncloneableClasses[funcClass] = false\ncloneableClasses[argsClass] = true\ncloneableClasses[arrayClass] = true\ncloneableClasses[boolClass] = true\ncloneableClasses[dateClass] = true\ncloneableClasses[numberClass] = true\ncloneableClasses[objectClass] = true\ncloneableClasses[regexpClass] = true\ncloneableClasses[stringClass] = true\n\nlet ctorByClass = {}\nctorByClass[arrayClass] = Array\nctorByClass[boolClass] = Boolean\nctorByClass[dateClass] = Date\nctorByClass[objectClass] = Object\nctorByClass[numberClass] = Number\nctorByClass[regexpClass] = RegExp\nctorByClass[stringClass] = String\n\n/** Used to match regexp flags from their coerced string values */\nlet reFlags = /\\w*$/\n\nlet cloneDeep = function (obj) {\n  if (typeof obj !== 'object' || !obj) return obj\n  if (Array.isArray(obj)) {\n    let ret = []\n    obj.forEach(function (item) {\n      ret.push(cloneDeep(item))\n    })\n    return ret\n  }\n  let className = toString.call(obj)\n  if (!cloneableClasses[className]) {\n    return obj\n  }\n  const Ctor = ctorByClass[className]\n  switch (className) {\n    case boolClass:\n    case dateClass:\n      return new Ctor(+obj)\n\n    case numberClass:\n    case stringClass:\n      return new Ctor(obj)\n\n    case regexpClass:\n      return Ctor(obj.source, reFlags.exec(obj))\n  }\n\n  let ret = {}\n  let keys = Object.keys(obj)\n  keys.forEach(function (key) {\n    ret[key] = cloneDeep(obj[key])\n  })\n  return ret\n}\n\nlet merge = function (obj1, obj2) {\n  if (typeof obj1 !== 'object' || !obj1) return obj1\n  if (Array.isArray(obj1)) {\n    obj2.forEach(function (item) {\n      if (obj1.indexOf(item) === -1) {\n        obj1.push(item)\n      }\n    })\n    return obj1\n  }\n  let keys = Object.keys(obj2)\n  keys.forEach(function (key) {\n    if (obj1[key] && typeof obj1[key] === 'object' && typeof obj2[key] === 'object') {\n      merge(obj1[key], obj2[key])\n    } else {\n      obj1[key] = obj2[key]\n    }\n  })\n  return obj1\n}\n\nlet utils = {\n  // 高效slice\n  slice: (a, start, end) => {\n    start = start || 0\n    end = end || a.length\n    if (start < 0) start += a.length\n    if (end < 0) end += a.length\n    let r = new Array(end - start)\n    for (let i = start; i < end; i++) {\n      r[i - start] = a[i]\n    }\n    return r\n  },\n\n  formatJSON: (obj) => {\n    return JSON.stringify(obj, null, 2)\n  },\n\n  getUriProtocol: function (uri) {\n    if (!uri) return null\n    return uri.substring(0, uri.indexOf(':'))\n  },\n\n  getUriPath: function (uri) {\n    let idx = uri.indexOf('//')\n    if (idx === -1) return ''\n    idx = uri.indexOf('/', idx + 2)\n    if (idx === -1) return ''\n    uri = uri.substr(idx)\n    idx = uri.indexOf('#')\n    if (idx === -1) idx = uri.indexOf('?')\n    if (idx !== -1) uri = uri.substr(0, idx)\n    return uri\n  },\n\n  cloneDeep,\n\n  merge\n}\n\nconst moduleUtils = function (name = 'utils') {\n  let app = this\n  app[name] = utils\n\n  return {\n    name: name,\n    unuse: function () {\n      delete app[name]\n    }\n  }\n}\n\nconst $ = {\n  utils: utils,\n  moduleUtils: moduleUtils\n}\n\nmodule.exports = $\n"],"names":["argsClass","arrayClass","boolClass","dateClass","funcClass","numberClass","objectClass","regexpClass","stringClass","cloneableClasses","ctorByClass","Array","Boolean","Date","Object","Number","RegExp","String","reFlags","cloneDeep","obj","isArray","ret","forEach","item","push","className","toString","call","Ctor","source","exec","keys","key","merge","obj1","obj2","indexOf","utils","slice","a","start","end","length","r","i","formatJSON","JSON","stringify","getUriProtocol","uri","substring","getUriPath","idx","substr","moduleUtils","name","app","unuse","$"],"mappings":"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"}